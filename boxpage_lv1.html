<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>Color Sudoku</title>
		<style>
			body { background-color: white; }
			table{
			display: inline;
			margin: auto;
			border-collapse:collapse;
			}
			td{
			border-style: solid;
			border-color: black;
			height: 20px;
			width: 20px;
			}
			
			.red{background-color: red;}
			.blue{background-color: blue;}
			.green{background-color: green;}
			.orange{background-color: orange;}
			.pink{background-color: pink;}
			.yellow{background-color: yellow;}
			.cyan{background-color: #00FFFF;}
			.brown{background-color: saddlebrown;}
			.purple{background-color: orchid;}
			
		</style>
		<script src="jquery-3.1.0.js"></script>
	</head>
	<body>
		<table>
		<tr>
			<td class="red" onclick="getColor('red',1)"></td>
			<td class="label">1</td>
		</tr>
		<tr>
			<td class="green" onclick="getColor('green',2)"></td>
			<td class="label">2</td>
		</tr>
		<tr>
			<td class="blue" onclick="getColor('blue',3)"></td>
			<td class="label">3</td>
		</tr>
		<tr>
			<td class="cyan" onclick="getColor('cyan',4)"></td>
			<td class="label">4</td>
		</tr>
		<tr>
			<td class="purple" onclick="getColor('purple',5)"></td>
			<td class="label">5</td>
		</tr>
		<tr>
			<td class="pink" onclick="getColor('pink',6)"></td>
			<td class="label">6</td>
		</tr>
		<tr>
			<td class="yellow" onclick="getColor('yellow',7)"></td>
			<td class="label">7</td>
		</tr>
		<tr>
			<td class="orange" onclick="getColor('orange',8)"></td>
			<td class="label">8</td>
		</tr>
		<tr>
			<td class="brown" onclick="getColor('brown',9)"></td>
			<td class="label">9</td>
		</tr>
		</table>
		<table>
		<tr>
			<td></td>
			<td id="col1"></td>
			<td id="col2"></td>
			<td id="col3"></td>
			<td id="col4"></td>
			<td id="col5"></td>
			<td id="col6"></td>
			<td id="col7"></td>
			<td id="col8"></td>
			<td id="col9"></td>
		</tr>
		<tr>
			<td id="row1"></td>
			<td id="1-1" onclick="setColor('1-1')"></td>
			<td id="1-2" onclick="setColor('1-2')"></td>
			<td id="1-3" onclick="setColor('1-3')"></td>
			<td id="1-4" onclick="setColor('1-4')"></td>
			<td id="1-5" onclick="setColor('1-5')"></td>
			<td id="1-6" onclick="setColor('1-6')"></td>
			<td id="1-7" onclick="setColor('1-7')"></td>
			<td id="1-8" onclick="setColor('1-8')"></td>
			<td id="1-9" onclick="setColor('1-9')"></td>
		</tr>
		<tr>
			<td id="row2"></td>
			<td id="2-1" onclick="setColor('2-1')"></td>
			<td id="2-2" onclick="setColor('2-2')"></td>
			<td id="2-3" onclick="setColor('2-3')"></td>
			<td id="2-4" onclick="setColor('2-4')"></td>
			<td id="2-5" onclick="setColor('2-5')"></td>
			<td id="2-6" onclick="setColor('2-6')"></td>
			<td id="2-7" onclick="setColor('2-7')"></td>
			<td id="2-8" onclick="setColor('2-8')"></td>
			<td id="2-9" onclick="setColor('2-9')"></td>
		</tr>
		<tr>
			<td id="row3"></td>
			<td id="3-1" onclick="setColor('3-1')"></td>
			<td id="3-2" onclick="setColor('3-2')"></td>
			<td id="3-3" onclick="setColor('3-3')"></td>
			<td id="3-4" onclick="setColor('3-4')"></td>
			<td id="3-5" onclick="setColor('3-5')"></td>
			<td id="3-6" onclick="setColor('3-6')"></td>
			<td id="3-7" onclick="setColor('3-7')"></td>
			<td id="3-8" onclick="setColor('3-8')"></td>
			<td id="3-9" onclick="setColor('3-9')"></td>
		</tr>
		<tr>
			<td id="row4"></td>
			<td id="4-1" onclick="setColor('4-1')"></td>
			<td id="4-2" onclick="setColor('4-2')"></td>
			<td id="4-3" onclick="setColor('4-3')"></td>
			<td id="4-4" onclick="setColor('4-4')"></td>
			<td id="4-5" onclick="setColor('4-5')"></td>
			<td id="4-6" onclick="setColor('4-6')"></td>
			<td id="4-7" onclick="setColor('4-7')"></td>
			<td id="4-8" onclick="setColor('4-8')"></td>
			<td id="4-9" onclick="setColor('4-9')"></td>
		</tr>
		<tr>
			<td id="row5"></td>
			<td id="5-1" onclick="setColor('5-1')"></td>
			<td id="5-2" onclick="setColor('5-2')"></td>
			<td id="5-3" onclick="setColor('5-3')"></td>
			<td id="5-4" onclick="setColor('5-4')"></td>
			<td id="5-5" onclick="setColor('5-5')"></td>
			<td id="5-6" onclick="setColor('5-6')"></td>
			<td id="5-7" onclick="setColor('5-7')"></td>
			<td id="5-8" onclick="setColor('5-8')"></td>
			<td id="5-9" onclick="setColor('5-9')"></td>
		</tr>
		<tr>
			<td id="row6"></td>
			<td id="6-1" onclick="setColor('6-1')"></td>
			<td id="6-2" onclick="setColor('6-2')"></td>
			<td id="6-3" onclick="setColor('6-3')"></td>
			<td id="6-4" onclick="setColor('6-4')"></td>
			<td id="6-5" onclick="setColor('6-5')"></td>
			<td id="6-6" onclick="setColor('6-6')"></td>
			<td id="6-7" onclick="setColor('6-7')"></td>
			<td id="6-8" onclick="setColor('6-8')"></td>
			<td id="6-9" onclick="setColor('6-9')"></td>
		</tr>
		<tr>
			<td id="row7"></td>
			<td id="7-1" onclick="setColor('7-1')"></td>
			<td id="7-2" onclick="setColor('7-2')"></td>
			<td id="7-3" onclick="setColor('7-3')"></td>
			<td id="7-4" onclick="setColor('7-4')"></td>
			<td id="7-5" onclick="setColor('7-5')"></td>
			<td id="7-6" onclick="setColor('7-6')"></td>
			<td id="7-7" onclick="setColor('7-7')"></td>
			<td id="7-8" onclick="setColor('7-8')"></td>
			<td id="7-9" onclick="setColor('7-9')"></td>
		</tr>
		<tr>
			<td id="row8"></td>
			<td id="8-1" onclick="setColor('8-1')"></td>
			<td id="8-2" onclick="setColor('8-2')"></td>
			<td id="8-3" onclick="setColor('8-3')"></td>
			<td id="8-4" onclick="setColor('8-4')"></td>
			<td id="8-5" onclick="setColor('8-5')"></td>
			<td id="8-6" onclick="setColor('8-6')"></td>
			<td id="8-7" onclick="setColor('8-7')"></td>
			<td id="8-8" onclick="setColor('8-8')"></td>
			<td id="8-9" onclick="setColor('8-9')"></td>
		</tr>
		<tr>
			<td id="row9"></td>
			<td id="9-1" onclick="setColor('9-1')"></td>
			<td id="9-2" onclick="setColor('9-2')"></td>
			<td id="9-3" onclick="setColor('9-3')"></td>
			<td id="9-4" onclick="setColor('9-4')"></td>
			<td id="9-5" onclick="setColor('9-5')"></td>
			<td id="9-6" onclick="setColor('9-6')"></td>
			<td id="9-7" onclick="setColor('9-7')"></td>
			<td id="9-8" onclick="setColor('9-8')"></td>
			<td id="9-9" onclick="setColor('9-9')"></td>
		</tr>
		</table>
		<div>
		<button onclick="generateNewBoard('easy')">Easy</button>
		<button onclick="generateNewBoard('medium')">Medium</button>
		<button onclick="generateNewBoard('hard')">Hard</button>
		</div>
		<script>
			//answer board
			var row1 = [2,9,5,7,4,3,8,6,1];
			var row2 = [4,3,1,8,6,5,9,2,7];
			var row3 = [8,7,6,1,9,2,5,4,3];
			var row4 = [3,8,7,4,5,9,2,1,6];
			var row5 = [6,1,2,3,8,7,4,9,5];
			var row6 = [5,4,9,2,1,6,7,3,8];
			var row7 = [7,6,3,5,3,4,1,8,9];
			var row8 = [9,2,8,6,7,1,3,5,4];
			var row9 = [1,5,4,9,3,8,6,7,2];
			var matrix = [row1,row2,row3,row4,row5,row6,row7,row8,row9];
			//blank board to be populated with user input to be set in generateNewBoard()
			var checkMatrix;
			
			//color currently chosen by user
			var currentColornumber = 0;
			var currentColor = "";
			var colors = ["","red","green","blue","cyan","purple","pink","yellow","orange","brown"];

			//counter for number of games played or attempted
			var gameCount =0;
			//counter for checking win condition
			var colortry;
			
			//matrix operations
			function randomRowSwap(){
				n = Math.floor(Math.random()*9);
				m = Math.floor(Math.random()*9);
				hold = matrix[n].slice();
				
				matrix[n] = matrix[m].slice();
				matrix[m] = hold.slice();
			}
			function randomColumnSwap(){
				n = Math.floor(Math.random()*9);
				m = Math.floor(Math.random()*9);
				hold = 0;
				
				for(var i=0;i<9;i++)
				{
					hold = matrix[i][n];
					matrix[i][n] = matrix[i][m];
					matrix[i][m] = hold;
				}
			}
			//end matrix operations
			
			//if multiple games are played resets onclick for cells that were previously prepopulated and static
			function set_onClick()
			{
				var id_string = "";
				for(var i=0;i<9;i++)
				{
					for(var j=0;j<9;j++)
					{
						id_string = (i+1).toString()+"-"+(j+1).toString();
						$("#"+id_string).attr("onclick","setColor('"+id_string+"')");//
					}
				}
			}
			
			//Check to see if user won the game
			function winConditionCheck()
			{
				function sortNumber(a,b) {return a - b;}
				var rowCompare;
				var colCompare;
				
				for(var i=0;i<9;i++)
				{
					//generate arrays representing row i and column i
					rowCompare = checkMatrix[i].slice();
					colCompare = [];
					for(var j=0;j<9;j++)
					{
						colCompare.push(checkMatrix[j][i]);
					}
					//numerically sort row and column
					rowCompare.sort(sortNumber);
					console.log(rowCompare);
					colCompare.sort(sortNumber)
					console.log(colCompare);
					//check to see if sorted row and column are both numbers 1-9 (win condition)
					for(var j=0;j<9;j++)
					{
						if(((j+1) !== rowCompare[j]) || ((j+1) !== colCompare[j]))
						{
							console.log("%i false",i);
							return false;
						}
					}
					return true
				}
			}
			
			//functions to choose and set cell colors
			function getColor(color, number)
			{
				currentColor = color;
				currentColornumber = number;
				colortry++;
			}
			
			function setColor(cellID)
			{
				var classCheck = document.getElementById(cellID).className.split(/\s+/);
				var checkIndices = cellID.split("-");
				
				$("#"+cellID).removeClass();	
				$("#"+cellID).addClass(currentColor);
				//updates the checkMatrix which tracks the game progress
				checkMatrix[parseInt(checkIndices[0])-1][parseInt(checkIndices[1])-1] = currentColornumber;
				//check for win condition
				if(colortry > 0)
				{
					winConditionCheck();
				}
			}			
			
			//populates html board
			function populateBoard()
			{
				var cell = "";
				for(var i=0;i<9;i++)
				{
					for(var j=0;j<9;j++)
					{
						currentColor = colors[checkMatrix[i][j]];
						currentColornumber = checkMatrix[i][j];
						cell = (i+1).toString()+"-"+(j+1).toString();
						$("#"+cell).html(checkMatrix[i][j]);
						setColor(cell);
					}
				}
				//clears currentColor so user cannot fill cells until they choose from palette
				currentColor = "";
			}
			//generates the matrix for the board the user will fill in
			function hideCells(given)
			{
				var index;
				var randomIndex
				var indices = [];
				var numbers = 81;
				var n = 0;
				for(var i=0;i<9;i++)
				{
					for(var j=0;j<9;j++)
					{
						indices.push(i.toString()+','+j.toString());
					}
				}
				
				while(n<given)
				{
					randomIndex = Math.floor(Math.random()*numbers);
					index = indices[randomIndex].split(',');
					indices.splice(randomIndex,1);
					checkMatrix[parseInt(index[0])][parseInt(index[1])] = matrix[parseInt(index[0])][parseInt(index[1])];
					given--;
					numbers--;
					//makes prepopulated cells static so users can't change them accidentally
					$("#"+(parseInt(index[0])+1).toString()+"-"+(parseInt(index[1])+1).toString()).prop("onclick",null);
				}
			}
			//scramble base answer board
			function generateNewBoard(difficulty)
			{
				checkMatrix = [[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];
				var given = 0;
				gameCount++;
				colortry = 0;
				if(gameCount>1)
				{
					set_onClick();
				}
				switch(difficulty){
					case "easy":
						given = 35;
						break;
					case "medium":
						given = 20;
						break;
					case "hard":
						given = 10;
						break;
				}
				
				for(var i=0;i<500;i++)
				{
					var pick = Math.random();
					
					if(pick > 0.5)
					{
						randomColumnSwap();
					}
					else
					{
						randomRowSwap();
					}
				}
				hideCells(given);
				populateBoard();
			}
		</script>
	</body>
</html>